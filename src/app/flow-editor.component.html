<div class="app-container">

    <div class="sidebar">
        <div class="section-header" (click)="toggleActions()">
            <h3>A√ß√µes</h3>
            <button class="toggle-btn">{{ showActions ? '‚ñº' : '‚ñ∂' }}</button>
        </div>

        <div class="actions-container" *ngIf="showActions">
            <button *ngFor="let tool of tools" (click)="addNode(tool.id, tool.label)" draggable="true"
                (dragstart)="onDragStart($event, tool.id, tool.label)" style="cursor: grab;">
                <span *ngIf="tool.icon" style="margin-right: 5px;">{{ tool.icon }}</span>
                {{ tool.label }}
            </button>
        </div>

        <hr style="border: 0; border-top: 1px solid #eee; margin: 10px 0;">

        <h3 style="margin: 5px 0;; font-size: 12px; text-transform: uppercase;">L√≥gica</h3>

        <button (click)="addNode('if')" draggable="true" (dragstart)="onDragStart($event, 'if', 'IF')"
            style="border-left: 4px solid #faad14; background: #fffbe6; cursor: grab;">
            üîÄ Condi√ß√£o (IF)
        </button>

        <hr style="border: 0; border-top: 1px solid #eee; margin: 10px 0;">

        <button (click)="triggerFileInput()"
            style="margin-top: 5px; border-color: #1890ff; color: #1890ff; background: #e6f7ff;">
            üìÇ Importar Fluxo
        </button>

        <input type="file" id="fileInput" style="display: none;" accept=".json" (change)="onFileSelected($event)">

        <button (click)="clearCanvas()" style="margin-top: 5px; border-color: #ff4d4f; color: #ff4d4f;">
            üóëÔ∏è Limpar Fluxo
        </button>

        <div class="instruction">
            <small>üñ±Ô∏è Arrastar e Conectar</small><br>
            <small>üóëÔ∏è Delete para apagar</small><br>
            <small>‚úèÔ∏è Clique Duplo para Editar</small>
        </div>
    </div>

    <div #container class="graph-container" (dragover)="onDragOver($event)" (drop)="onDrop($event)">
    </div>

    <div class="modal-overlay" *ngIf="modalState.visible">
        <div class="modal-box">
            <div class="modal-header" [class.warning]="modalState.type === 'confirm' || modalState.type === 'warning'">
                <span class="modal-icon">
                    {{ (modalState.type === 'confirm' || modalState.type === 'warning') ? '‚ö†Ô∏è' : '‚ÑπÔ∏è' }}
                </span>
                <h3>{{ modalState.title }}</h3>
            </div>
            <div class="modal-body">
                <p>{{ modalState.message }}</p>
            </div>
            <div class="modal-footer">
                <button *ngIf="modalState.type === 'confirm'" class="modal-btn cancel" (click)="closeModal()">
                    Cancelar
                </button>
                <button class="modal-btn confirm" [class.danger]="modalState.type === 'confirm'"
                    (click)="confirmModalAction()">
                    {{ modalState.confirmLabel || 'OK' }}
                </button>
            </div>
        </div>
    </div>
</div>